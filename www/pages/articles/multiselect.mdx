import { useState } from 'react';
import Post from '../../components/post';
import Example from '../../components/multiselect/example';
import { References, Reference } from '../../components/multiselect/reference';
import Debug from '../../components/multiselect/debug';

<Post title="Case Study: Multiselect">

__Goal__

Design a control that can be used to select multiple values from a list of many values.

__Requirements__

- Show selected values
- Show all options in a dropdown
- Allow searching for options
- Allow grouping of options
- Support standard `<select multiple>` keyboard/pointer controls

In addition to the above requirements, every control should be accessible, support progressive enhancement, and be responsive.

## Approach

Since there is a standard html control for this use case, the created control would be wise to follow the established patterns for interaction and behavior that users have come to expect and have been designed for accessibility and compatibility.

Standard `<select multiple>`:

```html
<select multiple>
  <option value="a">A</option>
  <option value="b">B</option>
  <option value="c">C</option>
</select>
```

<Example className="flex">
  <div className="flex">
    {(() => {
      const [value, setValue] = useState([]);
      const onChange = e => {
        const options = e.target.options;
        const value = [];
        for (const option of options) {
          if (option.selected) {
            value.push(option.value);
          }
        }
        setValue(value);
      }
      return <>
        <select multiple className="flex-1 border p-1" value={value} onChange={onChange}>
          <option value="a">A</option>
          <option value="b">B</option>
          <option value="c">C</option>
        </select>
        <Debug value={value} className="flex-1" />
      </>
    })()}

  </div>
</Example>

<References>
  <Reference title="Chrome">
    <img src="/static/images/multiselect/standard-chrome.png" alt="Standard in Chrome" />
  </Reference>
  <Reference title="Firefox">
    <img src="/static/images/multiselect/standard-firefox.png" alt="Standard in Firefox" />
  </Reference>
  <Reference title="Edge">
    <img src="/static/images/multiselect/standard-edge.png" alt="Standard in Edge" />
  </Reference>
  <Reference title="IE11">
    <img src="/static/images/multiselect/standard-ie11.png" alt="Standard in IE11" />
  </Reference>
  <Reference title="iOS">
    <img src="/static/images/multiselect/standard-iOS.jpeg" alt="Standard in iOS" width="175" />
  </Reference>
</References>

Based on the above standard approach, the desired structure for the multiselect component should generally be as follows:

```jsx
import React, { useState } from 'react';
import { Select, Option } from '@timhall/react-select';

function Form() {
  const [value, setValue] = useState([]);

  return (
    <form>
      <Select multiple value={value} onChange={setValue}>
        <Option value="a">A</Option>
        <Option value="b">B</Option>
        <Option value="c">C</Option>
      </Select>
    </form>
  );
}
```

</Post>
